This is the script.  I'll go through what it can do.